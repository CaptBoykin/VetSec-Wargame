#include <stdio.h>
#include <stdlib.h>

void callMe()
{
	printf("Successfully changed code flow and called the callMe function!\n");
	exit(0);
}

int main(int argc, char *argv[])
{
	volatile int (*functionPointer)();
	char buffer[64];

	functionPointer = 0;

	printf("Overflow the buffer to overwrite the function pointer so we can call the callMe function!");
	gets(buffer);

	if(functionPointer){
		printf("Calling function pointer, which is set to 0x%08x\n", functionPointer);
		functionPointer();
	}
	else{
		printf("Function pointer not overwritten correctly! Currently set to 0x%08x\n", functionPointer);
	}
	return 0;

}
